var Queue = require('bull');
var queue = new Queue('test');

var numRuns = 10000;
var finished = 0;
var finishTime, startTime;

var reportResult = function (result) {
  finished += 1;
  if (finished == numRuns) {
    finishTime = (new Date()).getTime();
    console.log('finished, ' + (finishTime - startTime));
  }
};

queue.process(function (job, done) {
  // console.log('Processing job ' + job.id);
  // return done(null, job.data.i);
  reportResult();
  return done();
});

startTime = (new Date()).getTime();

for (var i = 0; i < numRuns; i++) {
  queue.add({i: i});
  // var job = queue.createJob({i: i}).save().on('succeeded', reportResult);
}
